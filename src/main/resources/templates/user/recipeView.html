<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="/user_inc/header :: headerFragment"></th:block>
<style>
    .container{
        width:1200px;
    }
    .info:hover{
        color:#f29a1a;
    }
    #bookmark:hover{
        color:#f29a1a;
    }
</style>
<div class="container d-flex col-6" style="padding-top:150px;">
    <div class="me-3 col">
        <img th:src="${recipeDTO.ATT_FILE_NO_MAIN}" alt="Card image" style="width:700px;">
    </div>
    <div>
        <div class="d-flex justify-content-around align-items-center">
            <p class="m-3 col" th:text="${recipeDTO.RCP_PAT2}+' > '+${recipeDTO.RCP_WAY2}"></p>
            <div class="me-3" id="bookmark" style="cursor:pointer;" onclick="likeLoginCheck()"><i class="fa fa-bookmark fa-2x"></i></div>
        </div>
        <div class="d-flex align-items-end">
            <h4 class="m-3" th:text="${recipeDTO.RCP_NM}"></h4>
            <th:block th:if="${recipeDTO.HASH_TAG!=''}">
                <h6 class="m-3" th:text="'#'+${recipeDTO.HASH_TAG}"></h6>
            </th:block>
        </div>
        <hr class="m-3">
        <div class="d-flex w-100 col-6">
            <h7 class="m-3" style="width:100px;">재료 </h7>
            <p class="m-2" th:text="${recipeDTO.RCP_PARTS_DTLS}"></p>
        </div>
        <div class="d-flex w-100 col-6">
            <h5 class="m-3" style="width:100px;" th:text="영양정보"></h5>
        </div>
        <div class="d-flex w-100 col-6">
            <h7 class="ms-3 mt-1" style="width:70px;" th:text="열량"></h7>
            <p class="ms-2 mt-1" th:text="${recipeDTO.INFO_ENG}"></p>
        </div>
        <div class="d-flex w-100 col-6">
            <h7 class="ms-3 mt-1" style="width:70px;" th:text="탄수화물"></h7>
            <p class="ms-2 mt-1" th:text="${recipeDTO.INFO_CAR}"></p>
        </div>
        <div class="d-flex w-100 col-6">
            <h7 class="ms-3 mt-1" style="width:70px;" th:text="단백질"></h7>
            <p class="ms-2 mt-1" th:text="${recipeDTO.INFO_PRO}"></p>
        </div>
        <div class="d-flex w-100 col-6">
            <h7 class="ms-3 mt-1" style="width:70px;" th:text="지방"></h7>
            <p class="ms-2 mt-1" th:text="${recipeDTO.INFO_FAT}"></p>
        </div>
        <div class="d-flex w-100 col-6">
            <h7 class="ms-3 mt-1" style="width:70px;" th:text="나트륨"></h7>
            <p class="ms-2 mt-1" th:text="${recipeDTO.INFO_NA}"></p>
        </div>
    </div>
</div>
<br>
<br>
<div class="container d-flex mt-5 align-items-end">
    <h3 class="info">조리방법</h3>
</div>
<hr class="container mt-3">
<div class="container mt-5 mb-5">
<th:block th:replace="/user/recipeManual"></th:block>
    <th:block th:if="${recipeDTO.RCP_NA_TIP!=''}">
        <h4 class="mt-5">TIP!</h4>
        <h6 class="mt-3" th:text="${recipeDTO.RCP_NA_TIP}"></h6>
    </th:block>
</div>

<script>
    function likeLoginCheck(){
        if([[${session.userLoginDto?.user_id==null}]]){
            alert("로그인이 필요한 서비스입니다");
            return;
        }
        bookmarkRegister([[${recipeDTO.id}]]);
    }
    function bookmarkRegister(id){
        let user_id = "[[${session.userLoginDto?.user_id}]]";
        // let bm_recipe_id = [[${recipeDTO.id}]];
        let bm_recipe_rcp_nm = "[[${recipeDTO.RCP_NM}]]";
        let bm_recipe_att_file_no_main = "[[${recipeDTO.ATT_FILE_NO_MAIN}]]";
        let bm_recipe_rcp_pat2 = "[[${recipeDTO.RCP_PAT2}]]";
        let bm_recipe_rcp_way2 = "[[${recipeDTO.RCP_WAY2}]]";

        let bookmark = {
            bm_recipe_id:id, bm_recipe_rcp_nm,bm_recipe_rcp_nm,
            bm_recipe_att_file_no_main:bm_recipe_att_file_no_main, bm_recipe_rcp_pat2:bm_recipe_rcp_pat2,
            bm_recipe_rcp_way2,bm_recipe_rcp_way2
        };
        console.log(bookmark);
        $.ajax({
            url:"/user/bookmarkRegister/"+user_id,
            data: JSON.stringify(bookmark), // JSON객체를 문자열(텍스트) 변환
            contentType: "application/json; charset=utf8",
            type:"post",
            success:function(result){
                if(result=="register"){
                    alert("북마크 되었습니다.");
                }else if(result=="have"){
                    alert("이미 북마크되어 있습니다.");
                }else{
                    alert("등록 실패하였습니다.");
                }
            },
            error: () => {
            alert("요청을 실패하였습니다")
        }
        });
    }
</script>

<th:block th:replace="/user_inc/footer :: footerFragment"></th:block>
<th:block th:replace="/user_inc/footer :: scriptFragment"></th:block>